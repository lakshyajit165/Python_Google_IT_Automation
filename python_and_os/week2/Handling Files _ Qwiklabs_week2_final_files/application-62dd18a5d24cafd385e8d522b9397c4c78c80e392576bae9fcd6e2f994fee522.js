function _toConsumableArray(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)}function status(e){return 200<=e.status&&e.status<300?Promise.resolve(e):Promise.reject(e)}function json(e){return e.json()}function text(e){return e.text()}var ql={getJson:function(e){return fetch(e,{credentials:"include"}).then(status).then(json)},getHtml:function(e){return fetch(e,{credentials:"include"}).then(status).then(text)},Poller:function(e,t,n,i){this.continuePolling=!0,this.path=e,this.timeout=t,this.success=n,this.failure=i||this.defaultFailure,this.start=function o(){var t=this;this.continuePolling&&ql.getJson(this.path).then(this.success).then(function(){return setTimeout(o.bind(t),t.timeout)})["catch"](function(e){t.stop(),t.failure(e)})},this.once=function(){ql.getJson(this.path).then(this.success)["catch"](this.failure)},this.stop=function(){this.continuePolling=!1},this.defaultFailure=function(e){console.log("Request failed",e)}},events:{},subscribe:function(t,n){return ql.events[t]=ql.events[t]||[],ql.events[t].push(n),{unsubscibe:function i(){var e=ql.events[t].indexOf(n);ql.events[t].splice(e,1)}}},publish:function(e,t){ql.events[e]&&ql.events[e].forEach(function(e){e.call(this,t)})},debounce:function(o,e,t){var s,a=arguments.length<=1||e===undefined?20:e,r=arguments.length<=2||t===undefined||t;return function(){var e=this,t=arguments,n=function n(){s=null,r||o.apply(e,t)},i=r&&!s;clearTimeout(s),s=setTimeout(n,a),i&&o.apply(e,t)}},showFlash:function(e,t){var n=$("#flash-sibling-before"),i=$('<div class="alert"></div>');"notice"==e?i.addClass("alert-success"):i.addClass("alert-error");var o=$('<a class="alert__close" data-dismiss="alert"><i class="fa fa-times"></i></a>'),s=$('<iframe class="l-ie-iframe-fix"></iframe>');i.text(t),i.append(o),i.append(s),$(".alert").remove(),i.insertAfter(n)},moveFlash:function(e){$(function(){return $("#flash-sibling-before").insertAfter(e)})}};$.widget("custom.userAutocomplete",$.ui.autocomplete,{_renderItem:function _renderItem(e,t){return $("<li>").attr("data-value",t.value).append(ql.renderAutocompleteUser(t)).appendTo(e)}}),ql.renderAutocompleteUser=function(e){return"newUser"==e.value?'<div class="add-new-user js-add-new-user">\n      <i class="material-icons">add</i> Add New User\n    </div>':"<div class='autocomplete--user'>\n      <img src='https://secure.gravatar.com/avatar/"+e.label.gravatar_hash+".jpg?s=80&d=mm'/>\n      <div>\n        "+e.label.email+"\n        <span>"+e.label.first_name+" "+e.label.last_name+"</span>\n      </div>\n    </div>"},ql.autocomplete=function(){function e(){$(".js-user-autocomplete").userAutocomplete({source:t}),$(document).on("nested:fieldAdded",function(e){e.field.find(".js-user-autocomplete").userAutocomplete({source:t})})}function t(e,t){var n="?q["+this.element[0].dataset.query+"]="+e.term;ql.getJson(this.element[0].dataset.autocomplete+n).then(function(e){t(e.map(function(e){return{label:e,value:e.email}}))})}return{init:e,source:t}}(),ql.setCookie=function(e,t,n){var i=new Date;i.setTime(i.getTime()+24*n*60*60*1e3);var o="expires="+i.toUTCString();document.cookie=e+"="+t+";"+o+";path=/"},ql.hasAnalytics=function(){return"undefined"!=typeof analytics},ql.track=function(e,t){var n=arguments.length<=1||t===undefined?{}:t;ql.hasAnalytics()&&analytics.track(e,n)},ql.experiments=function(){function n(t){return i.find(function(e){return e.id===t})}function e(){return i}function t(e){var t=n(e);return null!=e&&t.variant}var i=[],o=document.querySelector('meta[name="active-experiments"]');if(o)try{i=JSON.parse(o.content)}catch(s){console.error(s)}else console.error("Missing active-experiments meta tag.");return{getActiveExperiments:e,getExperiment:n,getUserVariant:t}}(),ql.adminClassroomView=function(){function e(e){n=e,i=document.querySelector(".js-classroom-focuses"),t()}function t(){ql.getJson(n).then(function(e){return i.innerHTML=e.focuses}).then(function(){return setTimeout(t,1e4)})["catch"](function(e){return console.error(e.message)})}var n="",i="";return{init:e}}(),ql.analytics=function(){function e(){eventLinks=document.querySelectorAll("[data-analytics-action]"),eventLinks.forEach(function(e){return e.addEventListener("click",t,!1)})}function t(){ql.track(this.dataset.analyticsAction,{category:this.dataset.analyticsCategory,label:this.dataset.analyticsLabel})}return{init:e}}(),CampaignCodeModalSubmitEnable=function(){$("#campaign-code-modal-submit").prop("disabled",!1)},CampaignCodeModalSubmitDisable=function(){$("#campaign-code-modal-submit").prop("disabled",!0)},ql.catalogs={tracking:function(){function e(){document.querySelectorAll(".js-catalog-item-title a").forEach(function(e){return e.addEventListener("click",function(e){ql.track("clicked_catalog_list_item",{label:e.target.innerText,type:e.target.dataset.type})},!1)})}return{init:e}}(),filter:function(){function e(){$form=document.querySelector("#catalog-filter-form"),$form&&($inputs=$form.querySelectorAll("input"),$inputs.forEach(function(e){return e.addEventListener("click",t)}))}function t(e){var t="any",n=e.currentTarget.closest(".js-list-item"),i=n.querySelector('input[value="'+t+'"]');e.currentTarget.value===t?n.querySelectorAll('input:checked:not([value="'+t+'"])').forEach(function(e){a(e)}):i.checked&&a(i),n.querySelectorAll("input:checked").length||s(i),numActive=n.querySelectorAll('input:checked:not([value="'+t+'"])').length;var o=numActive?"("+numActive+")":"";n.querySelector(".active-filter-number").textContent=o,ql.track(this.checked?"checked_filter":"unchecked_filter",{label:this.id}),ql.catalogSearchFilter()}function n(e){return e.closest(".mdl-checkbox")}function s(e){n(e).classList.add("is-checked"),e.checked=!0}function a(e){n(e).classList.remove("is-checked"),e.checked=!1}return $form={},{init:e}}(),addItems:function(){function e(){$catalogItems=document.querySelector(".js-catalog-items"),$addButtons=document.querySelectorAll(".js-add-button"),$addButtons.forEach(function(e){e.addEventListener("click",t,!1)}),ql.subscribe("itemAdded",i)}function t(e){e.preventDefault(),e.stopImmediatePropagation(),$("#add_item_with_children").modal("hide"),n(this.href)}function n(e){fetch(e,{method:"POST",credentials:"include",headers:new Headers({"X-CSRF-Token":document.querySelector('meta[name="csrf-token"]').content,Accept:"application/json","Content-Type":"application/json"})}).then(status).then(json).then(function(e){return ql.publish("itemAdded",e)})["catch"](function(e){return console.log(e)})}function i(e){$firstCatalogItem=$catalogItems.querySelectorAll(".js-catalog-item")[0],$firstCatalogItem?$firstCatalogItem.insertAdjacentHTML("beforebegin",e.html):$catalogItems.insertAdjacentHTML("beforeend",e.html),$buttons=$catalogItems.querySelectorAll(".mdl-js-button"),$buttons.forEach(function(e){e.hasAttribute("data-upgraded")||componentHandler.upgradeElement(e)}),$visiblebuttons=$catalogItems.querySelectorAll(".js-item-visible"),$visiblebuttons.forEach(function(e){e.hasAttribute("data-listening")||ql.catalogs.editItems.upgradeVisibleButton(e)}),$priceFields=$catalogItems.querySelectorAll(".js-item-price"),$priceFields.forEach(function(e){e.hasAttribute("data-listening")||ql.catalogs.editItems.upgradePriceField(e)}),$oldItem=document.querySelector('.js-add-item[data-item="'+e.catalogableType+"_"+e.catalogableId+'"]'),$($oldItem).animate({height:0},200,function(){$oldItem.remove()})}return $addButtons=[],$catalogItems={},{init:e,addItem:n}}(),searchItems:function(){function e(){$active=window.localStorage.getItem("searchTab")?window.localStorage.getItem("searchTab"):"Labs",t(".js-tab"),t(".js-tab-content"),n(),$tabsContainer=document.querySelector(".js-catalogable-types"),$tabsContainer.addEventListener("click",i)}function t(e){$tabs=document.querySelectorAll(e),$tabs.forEach(function(e){e&&(e.dataset.tab==$active?e.classList.add("is-active"):e.classList.remove("is-active"))})}function n(){$paginationContainers=document.querySelectorAll(".pagination"),$paginationContainers.forEach(function(e){e&&(e.id!=$active.toLowerCase()?e.style.display="none":e.style.display="inline")})}function i(){$active=document.querySelector(".js-tab.is-active").dataset.tab,window.localStorage.setItem("searchTab",$active),n()}return{init:e}}(),dragAndDrop:function(){function e(){$modal=document.querySelector("#add_item_with_children"),$name=$modal.querySelector(".js-add-item-name"),$type=$modal.querySelector(".js-add-item-type"),$count=$modal.querySelector(".js-add-item-children-count"),$with_button=$modal.querySelector(".js-with-children"),$without_button=$modal.querySelector(".js-without-children"),$(".js-add-item").draggable({helper:"clone",appendTo:"body"}),$(".js-catalog-table").droppable({drop:t,activeClass:"is-droppable",hoverClass:"is-active"})}function t(e,t){var n=t.draggable[0];if(n.dataset.hasChildren){var i=n.dataset.name,o=n.dataset.type,s=n.dataset.children,a=n.querySelector(".js-add-with-children").href,r=n.querySelector(".js-add-without-children").href;$name.innerHTML=i,$type.innerHTML=o,$count.innerHTML=s,$with_button.href=a,$without_button.href=r,$("#add_item_with_children").modal("show")}else $addButton=n.querySelector(".js-add-button"),ql.catalogs.addItems.addItem($addButton.href)}return $addItems={},$modal={},$name={},$type={},$count={},$with_button={},$without_button={},{init:e}}(),editItems:function(){function e(){$catalogItems=document.querySelector(".js-catalog-items"),$visibleButtons=$catalogItems.querySelectorAll(".js-item-visible"),$visibleButtons.forEach(t),$priceFields=$catalogItems.querySelectorAll(".js-item-price"),$priceFields.forEach(n),ql.subscribe("itemUpdated",a)}function t(e){e.addEventListener("click",i,!1),e.dataset.listening="true"}function n(e){e.addEventListener("change",o,!1),e.dataset.listening="true"}function i(e){e.preventDefault(),e.stopImmediatePropagation(),s(this.href)}function o(){s(this.dataset.path.replace(/=.*/i,"="+this.value))}function s(e){fetch(e,{method:"PATCH",credentials:"include",headers:new Headers({"X-CSRF-Token":document.querySelector('meta[name="csrf-token"]').content,Accept:"application/json","Content-Type":"application/json"})}).then(status).then(json).then(function(e){return ql.publish("itemUpdated",e)})["catch"](function(e){return console.log(e)})}function a(e){$item=$catalogItems.querySelector('[data-item = "'+e.id+'"]'),$visibleButton=$item.querySelector(".js-item-visible");var t=e.visible?"0":"1",n=e.visible?"text--success":"text--light",i=$visibleButton.href.replace(/=\d/i,"="+t);$visibleButton.href=i,$visibleButton.classList.remove("text--success"),$visibleButton.classList.remove("text--light"),$visibleButton.classList.add(n),e.price&&($priceField=$item.querySelector(".js-item-price"),$priceField.value=e.price)}return $catalogItems={},$visibleButtons={},$priceFields={},{init:e,upgradeVisibleButton:t,upgradePriceField:n}}(),edit:function(){function e(){$enableButton=document.querySelector(".js-enable-catalog"),$enableIcon=$enableButton.querySelector(".material-icons"),$enableButton.addEventListener("click",t,!1),$fraudButton=document.querySelector(".js-fraud-catalog"),$fraudIcon=$fraudButton.querySelector(".material-icons"),$fraudButton.addEventListener("click",t,!1),ql.subscribe("catalogUpdated",i)}function t(e){e.preventDefault(),e.stopImmediatePropagation(),n(this.href)}function n(e){fetch(e,{method:"PATCH",credentials:"include",headers:new Headers({"X-CSRF-Token":document.querySelector('meta[name="csrf-token"]').content,Accept:"application/json","Content-Type":"application/json"})}).then(status).then(json).then(function(e){return ql.publish("catalogUpdated",e)})["catch"](function(e){return console.log(e)})}function i(e){var t=e.enabled_at?"0":"1",n=e.enabled_at?"check_box":"check_box_outline_blank",i=$enableButton.href.replace(/=\d/i,"="+t);$enableButton.href=i,$enableIcon.innerHTML=n;var o=e.fraud_protection?"0":"1",s=e.fraud_protection?"check_box":"check_box_outline_blank",a=$fraudButton.href.replace(/=\d/i,"="+o);$fraudButton.href=a,$fraudIcon.innerHTML=s}return $enableButton={},$enableIcon={},$fraudButton={},$fraudIcon={},{init:e}}()},initChosenListener=function(){$(".js-chosen").chosen({disable_search_threshold:20})},initChosen=function(){initChosenListener()},ql.focusDataPath="",ql.initStudentCheckBoxListeners=function(){var e=document.querySelectorAll(".js-select-student");[].concat(_toConsumableArray(e)).map(function(e){e.addEventListener("click",ql.handleStudentCheckBox)})},ql.handleStudentCheckBox=function(){ql.toggleStudentRow(this.closest("[data-student]")),ql.toggleStudentCheckBox(this.querySelector("i.material-icons")),ql.toggleActionButtons()},ql.toggleStudentRow=function(e){e.classList.toggle("is-selected")},ql.toggleStudentCheckBox=function(e){e.innerHTML=e.innerHTML.includes("blank")?"check_box":"check_box_outline_blank"},ql.toggleActionButtons=function(){var e=ql.getSelectedStudentRows(),t=e.filter(function(e){return"true"==e.dataset.running}),n=document.querySelector(".js-student-table-title"),i=document.querySelector(".js-student-actions-container"),o=i.querySelectorAll(".mdl-button");e.length?(n.style.display="none",i.style.display="block",0==t.length?o.forEach(function(e){return e.classList.add("mdl-button--disabled")}):o.forEach(function(e){return e.classList.remove("mdl-button--disabled")})):(n.style.display="flex",i.style.display="none")},ql.getSelectedStudentRows=function(){var e=document.querySelectorAll("[data-student]");return[].concat(_toConsumableArray(e)).filter(function(e){return e.classList.contains("is-selected")})},ql.initAddTimeListener=function(){document.querySelector(".js-add-time").addEventListener("click",ql.handleAddTime)},ql.handleAddTime=function(){ql.getSelectedStudentRows().filter(function(e){return"true"==e.dataset.running}).map(function(e){return e.dataset.addTimePath}).map(function(e){var t=new Request(e,{method:"POST",credentials:"include",headers:new Headers({"X-CSRF-Token":document.querySelector('meta[name="csrf-token"]').content})});fetch(t).then(status).then(json).then(function(){return ql.getJson(ql.focusDataPath).then(function(e){return ql.publish("received-focus-data",e)})})["catch"](function(e){return console.log("Request failed",e)})})},ql.initEndLabListener=function(){document.querySelector(".js-end-lab").addEventListener("click",ql.handleEndLab)},ql.handleEndLab=function(){ql.getSelectedStudentRows().filter(function(e){return"true"==e.dataset.running}).map(function(e){return e.dataset.endLabPath}).map(function(e){fetch(e,{credentials:"include"}).then(status).then(json).then(function(){return ql.getJson(ql.focusDataPath).then(function(e){return ql.publish("received-focus-data",e)})})["catch"](function(e){return console.log("Request failed",e)})})},ql.trainerClassroomView=function(){function t(e){e.students.forEach(function(e){var t=document.querySelector('[data-student="'+e.id+'"]');(t.dataset.labInstance=e.lab_instance.id,t.dataset.labState=e.lab_instance.lab_state,t.dataset.running=e.lab_instance.running,t.dataset.addTimePath=e.lab_instance.add_time_path,t.dataset.endLabPath=e.lab_instance.end_lab_path,t.querySelector(".js-status").innerHTML=e.lab_instance.status_html,e.lab_instance.score_html)&&(t.querySelector(".js-score").innerHTML=e.lab_instance.score_html)})}function n(e){e.running_hotlabs&&e.running_hotlabs.forEach(function(e){var t=document.querySelector("#focus_"+e.id).querySelector(".js-lab-details");0<e.hotlabs_running_count?t.innerHTML=e.hotlabs_running_count+" labs pre-warmed.":t.innerHTML=""})}function i(e){a&&(a.innerHTML=e.hotlabs_status)}function o(e){r&&(r.innerHTML=e.hotlabs_button)}function s(){ql.getJson(ql.focusDataPath).then(function(e){return ql.publish("received-focus-data",e)}).then(function(){return setTimeout(s,5e3)})["catch"](function(e){return console.log("Request failed",e)})}var a={},r={};return{init:function l(e){ql.focusDataPath=e,a=document.querySelector(".js-hotlabs"),r=document.querySelector(".js-hotlabs-button"),ql.subscribe("received-focus-data",i),ql.subscribe("received-focus-data",o),ql.subscribe("received-focus-data",n),ql.subscribe("received-focus-data",t),s(),document.querySelector("a.classroom__index-item.active").scrollIntoView()}}}(),ql.classroomResourceLabView=function(){function e(e){i=e,o=document.querySelector(".js-classroom-resource-lab"),ql.subscribe("received-resource-lab-data",n),t()}function t(){console.log("Polling Resource Lab Data: "+i),ql.getJson(i).then(function(e){return ql.publish("received-resource-lab-data",e)}).then(function(){return setTimeout(t,5e3)})["catch"](function(e){return console.log("Request failed",e)})}function n(e){o.innerHTML=e.html}var i="",o="";return{init:e}}(),ql.classroomStudentView=function(){function e(e){i=e,o=document.querySelectorAll(".js-focus-row"),ql.subscribe("received-student-data",n),t()}function t(){ql.getJson(i).then(function(e){return ql.publish("received-student-data",e)}).then(function(){return setTimeout(t,5e3)})["catch"](function(e){return console.log("Request failed",e)})}function n(e){e.focuses.forEach(function(t){[].concat(_toConsumableArray(o)).filter(function(e){return e.dataset.focus==t.id}).shift().innerHTML=t.html})}var i="",o="";return{init:e}}();var initClipboardToolTips=function initClipboardToolTips(e){e.on("success",function(e){$(e.trigger).attr("title",trans.copied).tooltip("fixTitle").tooltip("show"),$(e.trigger).mouseout(function(){$(this).tooltip("hide").tooltip("destroy")})}),e.on("error",function(e){var t="";t=/iPhone|iPad/i.test(navigator.userAgent)?trans.no_support:/Mac/i.test(navigator.userAgent)?trans.mac_press:trans.windows_press,$(e.trigger).attr("title",t).tooltip("fixTitle").tooltip("show"),$(e.trigger).mouseout(function(){$(this).tooltip("hide").tooltip("destroy")})})};ql.collaboratorsEdit=function(){function e(){$collaboratorList=$(".js-collaborator-list"),$errorFeedback=$(".js-add-collaborator-error"),t(),n()}function t(){$(".js-add-collaborator-form").on("ajax:before",function(){$errorFeedback.empty()}).on("ajax:success",function(e,t){i(t.rendered)}).on("ajax:error",function(e,t){o(t.responseJSON)})}function n(){$(document).on("ajax:success",".js-collaborator-item",function(e){e.currentTarget.remove(),e.preventDefault()}).on("ajax:error",".js-delete-permission",function(e,t){o(t.responseJSON)})}function i(e){$collaboratorList.append(e),$collaboratorList.scrollTop($collaboratorList[0].scrollHeight),$collaboratorList.find(".mdl-list__item").last().addClass("is-new")}function o(e){errors=e.errors,errors.forEach(function(e){$errorFeedback.append("<p>"+e+"</p>")})}return $collaboratorList="",$errorFeedback="",{init:e}}(),ql.course={schedule:function(){function e(){i=document.querySelectorAll(".js-more-details"),o=document.querySelectorAll(".js-less-details"),i.forEach(function(e){e.addEventListener("click",t,!1)}),o.forEach(function(e){e.addEventListener("click",n,!1)})}function t(e){e.preventDefault(),this.style.display="none",this.parentElement.querySelector(".js-less-details").style.display="block"}function n(e){e.preventDefault(),this.style.display="none",this.parentElement.querySelector(".js-more-details").style.display="block"}var i=undefined,o=undefined;return{init:e}}()},ql.discovery=function(){function e(){t(".in-progress-cards .js-content-card","in-progress"),t(".favorite-cards .js-content-card","favorite"),t(".curated-cards .js-content-card","curated"),t(".featured-cards .js-content-card","featured"),t(".upcoming-cards .js-content-card","upcoming"),t(".popular-cards .js-content-card","popular")}function t(e,r){document.querySelectorAll(e).forEach(function(a){a.addEventListener("click",function(){var e=a.dataset,t=e.id,n=e.name,i=e.type,o=e.level,s=e.path;ql.track("discover_catalog_item",{label:r,id:t,name:n,type:i,level:o,path:s})})})}return{init:e}}(),ql.favoriting=function(){function e(){document.querySelectorAll(".js-favorite-button").forEach(function(e){e.addEventListener("click",t,!1)})}function t(e){e.preventDefault(),e.stopImmediatePropagation(),n.call(this),o.call(this)}function n(){var e=i(this.dataset.type),t=this.dataset.name;this.href.includes("unfavorite")?ql.track("clicked_unfavorite_button",{type:e,label:t}):ql.track("clicked_favorite_button",{type:e,label:t})}function i(e){var t=undefined;switch(e){case"CatalogItem":t="Lab";break;case"LearningPath":t="Quest";break;case"ClassroomTemplate":t="Course";break;default:cateogry=e}return t}function o(){var t=this,e=new Request(this.href,{method:"POST",credentials:"include",headers:new Headers({"X-CSRF-Token":document.querySelector('meta[name="csrf-token"]').content})});fetch(e).then(status).then(json).then(function(e){console.log(e),e.alert?console.error(e.alert):(t.href=e.path,t.querySelector("i").innerHTML=e.icon,t.nextElementSibling.innerHTML=e.tooltip,$card=t.closest(".js-content-card"),$card&&$card.classList.toggle("is-unfavorited"))})}return{init:e}}(),ql.game=function(){function e(e){var t=document.querySelector(".js-lab-leaderboard");null!=e&&null!=t&&(t.players=JSON.parse(e))}return{updateLabLeaderboard:e}}(),ql.initHeader=function(){$(".js-header-search-bar-button").click(function(){$(".js-header-search-bar").addClass("is-open"),$(".js-header-search-bar input").focus()}),$(".js-header-search-bar .mdl-button").click(function(){$(".js-header-search-bar").removeClass("is-open")})},ql.catalogSearchFilter=function(){var e=document.querySelector("#catalog-filter-form"),t=document.querySelector(".js-header-search-bar.is-open")?document.querySelector("#catalog-search-mobile"):document.querySelector("#catalog-search");return e?(e.querySelector("#keywords").value=t.querySelector("#keywords").value,e.querySelector("#locale").value=t.querySelector("#locale").value,e.submit()):t&&t.submit(),!1},ql.header={myAccount:function(){function e(){n=document.querySelector(".js-my-account-menu"),i=document.querySelector(".js-main"),n&&($myAccountButton=document.querySelector(".js-my-account-button"),$myAccountButton.addEventListener("click",t,!1))}function t(){n.classList.toggle("is-open")?(ql.track("opened_my_account_menu"),i.addEventListener("click",t,!1)):i.removeEventListener("click",t,!1)}var n=undefined,i=undefined;return{init:e}}()},function(n){function i(e,t){this.instructionId=e,this.refreshPage=t,this.refreshing=!1,this.refresh=function(){var t=this;this.refreshing?console.log("Already polling. Ignoring this refresh."):(this.startRefreshing(),$.post("/authoring/instructions/"+this.instructionId+"/refresh.json").done(function(){setTimeout(function(){return t.pollStatus()},2e3)}).fail(function(e){console.log(e),t.stopRefreshing()}))},this.pollStatus=function(){var t=this;n.getJson("/instructions/"+this.instructionId+"/status.json").then(function(e){"failed"==e.state?(n.showFlash("error",e.message),t.stopRefreshing()):"completed"==e.state?(n.showFlash("notice",e.message),t.refreshPage?window.location.reload():t.stopRefreshing()):setTimeout(function(){return t.pollStatus()},5e3)})["catch"](function(e){t.stopRefreshing(),console.log(e)})},this.startRefreshing=function(){var e=this.instructionId;this.refreshing=!0,$(".refresh-instruction-spinner-"+e).removeClass("hidden"),$(".refresh-instruction-button-"+e).addClass("hidden")},this.stopRefreshing=function(){var e=this.instructionId;this.refreshing=!1,$(".refresh-instruction-spinner-"+e).addClass("hidden"),$(".refresh-instruction-button-"+e).removeClass("hidden")}}n.refreshInstruction=function(e,t){new i(e,t).refresh()}}(ql),ql.jupyter={startListener:function(){function e(){var e=document.querySelector("ql-jupyter-notebook"),t=document.querySelector(".button--start");t&&t.addEventListener("click",function(){t.setAttribute("disabled","disabled"),t.closest(".js-start-panel").classList.add("is-hidden"),e.loading=!0},!1)}return{init:e}}(),endListener:function(){function e(){var e=document.querySelector(".button--end");e&&e.addEventListener("click",function(){e.setAttribute("disabled","disabled")},!1)}return{init:e}}(),poller:function(){function e(e){i=document.querySelector("ql-jupyter-notebook"),new ql.Poller(e,3e3,t,n).start()}function t(e){if(console.log("polled!",e),(e.isExpired||e.errors)&&n(),e.provisioning||(i.labInstanceId=e.labInstanceId),e.labTimer.ticking){var t=e.labTimer.secondsRemaining;hours=Math.floor(t/3600),t%=3600,minutes=Math.floor(t/60),seconds=t%60,displayTimer=hours+"hr "+minutes+"m",document.querySelector(".js-timer").innerHTML=displayTimer}}function n(){document.querySelector(".button--end").click()}undefined;var i=undefined;return{init:e}}(),activityTracking:function(){function e(){document.querySelectorAll(".js-verify").forEach(function(e){e.addEventListener("click",t,!1)})}function t(e){var t=this;e.preventDefault();var n=this.dataset.step;ql.getJson(this.href).then(function(e){e.step_complete[n]&&t.closest(".js-checkpoint").classList.add("is-complete"),hallofmirrors.snackbarService.alert(e.messages[n])})}return{init:e}}()},initLaunchWithSubscriptionButtonListener=function(){$(".js-launch-with-subscription-button").click(function(){$(this).attr("disabled")||($(".js-launch-with-credits-input").val(0),$(".js-launch-with-subscription-input").val(1),submitLabAccessForm())})},initLaunchWithCreditsButtonListener=function(){$(".js-launch-with-credits-button").click(function(){$(this).attr("disabled")||($(".js-launch-with-credits-input").val(1),$(".js-launch-with-subscription-input").val(0),submitLabAccessForm())})},initLaunchWithAccessCodeButtonListener=function(){$(".js-launch-with-access-code-button").click(function(){$(this).attr("disabled")||($(".js-launch-with-credits-input").val(0),$(".js-launch-with-subscription-input").val(0),submitLabAccessForm())})},initLabAccessFormListener=function(){$(".js-lab-access-form").on("ajax:success",function(){launchLab()}).on("ajax:error",function(e,t){$(".js-access-code input").val(""),alertLabAccessError(t.responseText)}).on("ajax:complete",function(){enableLabAccessModalButtons()})},submitLabAccessForm=function(){ql.labControlPanel.setStarting(),disableLabAccessModalButtons(),$(".js-lab-access-form").submit()},launchLab=function(){$("#lab-access-modal").modal("hide"),ql.labRun.startLab({justPaid:!0})},alertLabAccessError=function(e){$("#lab-access-modal").modal("hide"),$(".js-alert-message").html(e),$(".js-alert").removeClass("alert-success").addClass("alert-error").css("display","flex")},disableLabAccessModalButtons=function(){$(".js-lab-access-modal-button").attr("disabled",!0)},enableLabAccessModalButtons=function(){$(".js-lab-access-modal-button").attr("disabled",!1)},initLabAccessModal=function(){initLaunchWithSubscriptionButtonListener(),initLaunchWithCreditsButtonListener(),initLaunchWithAccessCodeButtonListener(),initLabAccessFormListener()},ql.labAlert={alertMessage:function Of(e){$(".js-alert-message").html(e),$(".js-alert").removeClass("alert-success").addClass("alert-error").css("display","flex")},alertHttpError:function Pf(e){e.response.text().then(function(e){ql.labAlert.alertMessage(e)})}},ql.labAssessment=function(){var n=function n(e,t){$.get("/assessments/run_step.json?id="+e+"&step="+t).done(function(e){ql.labAssessment.update(e),int_no=parseInt(t)-1,e.completion_only?e.step_scores[int_no]==e.step_points[int_no]?alert("Step is complete. "):alert("Step is incomplete."):alert("Check complete.\n        Points earned: "+e.step_scores[int_no]+"\n        Message: "+e.student_messages[int_no])}).fail(function(){alert("Failed to update assessment")})};return{init:function e(){$(".js-lab-assessment-tab").click(function(){$(".js-lab-assessment-tab").toggleClass("is-open"),$(".js-lab-assessment-panel").toggleClass("is-open")}),$(".js-show-run-step-button").on("click",function(){var e=ql.labData.getLabInstanceId(),t=$(this).attr("step_no");e!==undefined&&ql.labData.isRunning()&&n(e,t)})},update:function o(e){if(void 0!==e&&"undefined"!=typeof e.total_score&&0!==e.total_score.length){var t="";for(t=e.completion_only?e.completed_steps+"/"+e.total_steps:e.total_score+"/"+e.perfect_score,$(".js-lab-assessment-total-score").html(t),i=1;i<=parseInt(e.total_steps);i++)e.completion_only?e.step_complete[i-1]?($(".js-assessment-step-score-"+i+" i:first-child").addClass("fa-check"),$(".js-assessment-step-score-"+i+" i:first-child").removeClass("fa-times")):($(".js-assessment-step-score-"+i+" i:first-child").addClass("fa-times"),$(".js-assessment-step-score-"+i+" i:first-child").removeClass("fa-check")):$(".js-assessment-step-score-"+i).html(e.step_scores[i-1])}},reset:function t(){var e=$(".js-lab-assessment-total-score").html();void 0!==e&&(e=e.replace(/.*\//,"\u2014/"),$(".js-lab-assessment-total-score").html(e),$('*[class^="js-assessment-step-score"]').html("\u2014"))}}}();var t="";initFakeAlertCloseListener=function(){$(".js-alert-close").click(function(){$(".js-alert").hide()})},initCopyCode=function(){$("pre code").each(function(t,e){$(e).after('<button class="button button--copy js-copy-button-'+t+'"><i class="fa fa-clipboard"></i></button>');var n=document.getElementsByClassName("no-select")[0],i=new Clipboard(".js-copy-button-"+t,{target:function o(e){return n&&n.classList.remove("no-select"),e.previousElementSibling}});i.on("success",function(){n&&n.classList.add("no-select"),document.getSelection().removeAllRanges(),$(".js-copy-button-"+t).attr("title",trans.copied).tooltip("fixTitle").tooltip("show")}),i.on("error",function(){n&&n.classList.add("no-select"),document.getSelection().removeAllRanges();var e="";e=/iPhone|iPad/i.test(navigator.userAgent)?trans.no_support:/Mac/i.test(navigator.userAgent)?trans.mac_press:trans.windows_press,$(".js-copy-button-"+t).attr("title",e).tooltip("fixTitle").tooltip("show")}),$(".js-copy-button-"+t).mouseout(function(){$(this).tooltip("hide").tooltip("destroy")})})},initImageZoom=function(){$(".js-lab-content img").click(function(){var e=$(this).attr("src");$("body").append('<div class="lab-content__image-overlay js-zoomed-image"><img class="lab-content__image" src='+e+" /></div>").find(".js-zoomed-image").click(function(){$(".js-zoomed-image").remove()})})},initPrettyPrint=function(){$(function(){prettyPrint()})},initCodeTabs=function(){var e=Array.from(document.querySelectorAll("ql-code"));e.forEach(function(n){return n.addEventListener("tabchange",function(t){return e.filter(function(e){return e!==n}).forEach(function(e){return e.setLanguage(t.detail.newTab.language)})})})},initLabContent=function(){initFakeAlertCloseListener(),initCopyCode(),initImageZoom(),initPrettyPrint(),initCodeTabs()},ql.labControlPanel=function(){var t=undefined;return{init:function e(){(t=document.querySelector(".js-lab-control-panel")).addEventListener("clickedStartLab",function(){return ql.labRun.startLab({justPaid:!1})}),t.addEventListener("clickedStopLab",function(){window.confirm(trans.are_you_sure)&&ql.labRun.stopLab()})},update:function n(e){t.labControlButton=e.labControlButton,t.labTimer=e.labTimer,t.billingLimitRemainder=e.billingLimitRemainder,t.provisioning=e.provisioning,t.provisioningSecondsRemaining=e.provisioningSecondsRemaining,t.openConsoleButton=e.consoleButton,t.connectionDetails=e.connectionDetails,t.connectionFiles=e.connectionFiles},reset:function i(){t.labControlButton={running:!1,pending:!1},t.billingLimitRemainder=ql.labData.getLabBillingLimit(),t.provisioning=!1,t.provisioningSecondsRemaining=null,t.openConsoleButton=null,t.connectionDetails=[],t.connectionFiles=[],t.labTimer={ticking:!1,secondsRemaining:ql.labData.getLabDuration()}},setStarting:function o(){t.labControlButton={running:!1,pending:!0}},setStopping:function s(){t.labControlButton={running:!0,pending:!0}},setRunning:function a(){t.labControlButton={running:!0,pending:!1}}}}(),ql.labData=function(){var e=undefined,t=undefined;return{clearLabInstanceId:function n(){t=null},getLabInstanceId:function i(){return t},setLabInstanceId:function o(e){t=e},getAnalyticsPayload:function s(){return e.analyticsPayload},getLabBillingLimit:function a(){return Number(e.labBillingLimit)},getLabDuration:function r(){return Number(e.labDuration)},getFocusId:function l(){return e.focusId},getParent:function c(){return e.parent},getQlcampaign:function u(){return e.qlcampaign},isPaymentRequired:function d(){return null!=e.paymentRequired},isRunning:function f(){return null!=t},init:function m(){e=$(".js-lab-state").data(),t=e.labInstanceId}}}(),ql.editRows=function(){function e(){s=document.querySelectorAll(".js-edit-row"),a=document.querySelector(".js-edit-title"),r=[a].concat(_toConsumableArray(s)),s.forEach(function(e){return e.addEventListener("click",n)}),a.addEventListener("click",o),$errorFields=document.querySelectorAll(".has-error"),$errorFields.forEach(function(e){$row=e.closest(".js-edit-row"),i($row)}),$inputs=document.querySelectorAll(".js-lab-details input"),$inputs.forEach(function(e){e.addEventListener("keyup",t)})}
function t(){$editRow=this.closest(".js-edit-row"),this.checkValidity()?$editRow.classList.remove("is-invalid"):$editRow.classList.add("is-invalid")}function n(){if(!this.classList.contains("is-selected")){o(),i(this);var e=this.querySelectorAll("input"),t=this.querySelectorAll("select"),n=this.querySelectorAll("textarea");n[0]?n[0].focus():t[0]?t[0].focus():e[0]&&e[0].focus()}}function i(e){var t=r.indexOf(e);r[t].classList.add("is-selected"),r[t].style.height=e.scrollHeight+24+"px",r[t-1]&&r[t-1].classList.add("is-bottom"),r[t+1]&&r[t+1].classList.add("is-top")}function o(){r.forEach(function(e){e.classList.remove("is-selected"),e.classList.remove("is-bottom"),e.classList.remove("is-top"),e.style.height="64px"})}var s="",a="",r=[];return{init:e}}(),ql.additionalResources=function(){function e(){$(document).on("nested:fieldAdded",t),$(document).on("nested:fieldRemoved",n)}function t(e){$editRow=e.target.closest(".js-edit-row"),$editRow.style.height=$editRow.scrollHeight+16+"px",ql.initMaterialInputs($editRow)}function n(e){$editRow=e.target.closest(".js-edit-row"),$editRow.style.height=$editRow.scrollHeight-i-16+"px"}var i=122;return{init:e}}(),ql.deploymentManager=function(){function e(){n=document.querySelector(".js-dm"),i=document.querySelector(".js-remove-dm-button"),o=document.querySelector(".js-remove-dm"),i.addEventListener("click",t)}function t(){n.href="",n.style.color="red",n.style.fontWeight="400",n.style.textDecoration="line-through",o.value=1,i.remove()}var n="",i="",o="";return{init:e}}(),ql.cloudFormation=function(){function e(){n=document.querySelector(".js-cf"),i=document.querySelector(".js-remove-cf-button"),o=document.querySelectorAll(".js-remove-cf"),i.addEventListener("click",t)}function t(){n.href="",n.style.color="red",n.style.fontWeight="400",n.style.textDecoration="line-through",o.forEach(function(e){return e.value=""}),i.remove()}var n="",i="",o="";return{init:e}}(),ql.studentPolicy=function(){function e(){n=document.querySelector(".js-sp"),i=document.querySelector(".js-remove-sp-button"),o=document.querySelectorAll(".js-remove-sp"),i.addEventListener("click",t)}function t(){n.href="",n.style.color="red",n.style.fontWeight="400",n.style.textDecoration="line-through",o.forEach(function(e){return e.value=""}),i.remove()}var n="",i="",o="";return{init:e}}(),ql.instruction=function(){function e(){$instructionContent=document.querySelector(".js-instruction-content"),$instructionHeader=document.querySelector(".js-instruction-header"),$instructionLoader=document.querySelector(".js-instruction-loader"),$instructionRefresh=document.querySelector(".js-instruction-refresh"),ql.subscribe("received-instruction-status",o),$instructionRefresh&&$instructionRefresh.addEventListener("click",t,!1)}function t(e){e.stopImmediatePropagation(),e.preventDefault(),$instructionContent.classList.add("is-faded"),$instructionLoader.classList.remove("is-hidden");var t=new Request(this.href,{method:"POST",credentials:"include",headers:new Headers({"X-CSRF-Token":document.querySelector('meta[name="csrf-token"]').content})});fetch(t).then(status).then(json).then(function(e){return n(e.status_path)})["catch"](a)}function n(e){instructionPoller=new ql.Poller(e,1e3,i,a),instructionPoller.start()}function i(e){ql.publish("received-instruction-status",e)}function o(e){"completed"==e.state&&(instructionPoller.stop(),ql.getHtml(e.display_path).then(s)["catch"](a))}function s(e){$instructionContent.innerHTML=e,$instructionContent.classList.remove("is-faded"),$instructionContent.classList.remove("is-hidden"),$instructionHeader.classList.remove("has-error"),$instructionLoader.classList.add("is-hidden")}function a(e){var t="Response not a JSON";"string"==typeof e?e.json().then(function(e){t=e.errors}):t=e.statusText,htmlSafeMessage=$("<div>").text(t).html(),$instructionContent.innerHTML="<div class='lab__instructions__error'>\n        <i class='material-icons'>error_outline</i>\n        <p>"+htmlSafeMessage+"</p>\n      </div>",$instructionContent.classList.remove("is-faded"),$instructionContent.classList.remove("is-hidden"),$instructionHeader.classList.add("has-error"),$instructionLoader.classList.add("is-hidden")}return $instructionCard="",$instructionContent="",$instructionHeader="",$instructionLoader="",$instructionRefresh="",instructionPoller={},{init:e,poll:n}}(),ql.downloadLab=function(){function e(){function e(){t.setAttribute("disabled","disabled"),t.querySelector("i").innerText="checkmark"}var t=document.getElementById("file_download-header");null!==t&&t.addEventListener("click",e)}return{init:e}}(),ql.publishLab=function(){function e(){$publishButton=document.querySelector(".js-publish-button"),$toast=document.querySelector(".js-toast"),$toastMessage=document.querySelector(".js-toast-message"),$toastLoader=$toast.querySelector(".mdl-js-progress"),ql.subscribe("received-publish-status",o),$publishButton.addEventListener("click",t)}function t(e){e.preventDefault();var t=new Request(this.href,{method:"POST",credentials:"include",headers:new Headers({"X-CSRF-Token":document.querySelector('meta[name="csrf-token"]').content})});fetch(t).then(status).then(json).then(function(e){return n(e.status_path)})["catch"](console.error)}function n(e){publishPoller=new ql.Poller(e,500,i),publishPoller.start()}function i(e){ql.publish("received-publish-status",e)}function o(e){"done"==e.status||"error"==e.status?(publishPoller.stop(),$toastLoader.classList.remove("is-visible"),$toastMessage.innerHTML=e.html):$toastLoader.classList.contains("is-visible")||($toastLoader.classList.add("is-visible"),$toastMessage.innerHTML=e.html),"error"===e.status?(ql.showFlash("warn",e.html),$toast.classList.remove("is-visible")):$toast.classList.add("is-visible")}return $publishButton="",$toast="",$toastMessage="",$toastLoader="",publishPoller={},{init:e,poll:n}}(),ql.labLocale=function(){function e(){$newLocaleButton=document.querySelector(".js-new-locale"),$dialog=document.querySelector(".js-dialog"),$localeDialogBody=$dialog.querySelector(".js-new-lab-locale"),localeDialog=new ql.MaterialDialog($dialog),$newLocaleButton.addEventListener("click",t)}function t(e){e.preventDefault(),ql.getHtml(this.href).then(n).then(i)["catch"](console.error)}function n(e){$localeDialogBody.innerHTML=e,ql.initMaterialInputs($localeDialogBody),localeDialog.open()}function i(){$(document).on("ajax:success","form",function(e,t,n,i){$(document).off("ajax:success"),localeDialog.close(),window.location.replace(i.responseJSON.url)}).on("ajax:error","form",function(e,t,n,i){console.error(i)})}return $dialog="",$newLocaleButton="",$localeDialogBody="",localeDialog={},{init:e}}(),ql.tagSelect=function(){function e(){n=document.querySelector(".js-chosen-tags").closest(".js-edit-row"),$(".js-chosen-tags").chosen().change(t)}function t(){$chosenContainers=n.querySelectorAll(".chosen-container");var t=293;$chosenContainers.forEach(function(e){t+=e.offsetHeight}),n.style.height=t+"px"}var n=undefined;return{init:e}}(),ql.permissionsSelect=function(){function e(){r=document.querySelector(".js-permissions-advanced-link"),a=document.querySelector(".js-chosen-permissions"),(s=document.querySelector(".js-permissions-input")).addEventListener("change",n),r.addEventListener("click",i),$(".js-chosen-permissions").chosen().change(t)}function t(){var e=[].concat(_toConsumableArray(this.selectedOptions)).map(function(e){return e.value}).join("\r\n");s.value=e,o()}function n(){this.classList.contains("is-visible")&&([].concat(_toConsumableArray(a.querySelectorAll("option"))).forEach(function(e){return e.selected=!1}),this.value.split("\n").forEach(function(e){var t=a.querySelector("[value='"+e+"']");t&&(t.selected=!0)}),$(".js-chosen-permissions").trigger("chosen:updated"));o()}function i(){s.classList.toggle("is-visible"),$chosen=document.querySelector(".js-permissions .chosen-container"),$chosen.classList.toggle("is-hidden"),$editRow=this.closest(".js-edit-row"),$editRow.classList.toggle("is-advanced"),newLabel=this.dataset.label,oldLabel=this.innerText,this.setAttribute("data-label",oldLabel),this.innerText=newLabel,o()}function o(){$chosen=document.querySelector(".js-permissions .chosen-container"),h=$chosen.offsetHeight,$editRow=$chosen.closest(".js-edit-row"),$editRow.style.height=h+114+"px"}var s="",a="",r="";return{init:e}}(),ql.disableLab=function(){function e(){$disableButton=document.querySelector(".js-disable-lab"),$disableIcon=$disableButton.querySelector(".material-icons"),$disableButton.addEventListener("click",t,!1),$disableNotice=document.querySelector(".js-disable-notice"),ql.subscribe("labUpdated",i)}function t(e){e.preventDefault(),e.stopImmediatePropagation(),n(this.href)}function n(e){fetch(e,{method:"PATCH",credentials:"include",headers:new Headers({"X-CSRF-Token":document.querySelector('meta[name="csrf-token"]').content,Accept:"application/json","Content-Type":"application/json"})}).then(status).then(json).then(function(e){return ql.publish("labUpdated",e)})["catch"](function(e){return console.log(e)})}function i(e){var t=e.disabled_for_catalogs_at?"disable":"enable",n=e.disabled_for_catalogs_at?"enable":"disable",i=e.disabled_for_catalogs_at?"check_box":"check_box_outline_blank",o=$disableButton.href.replace(t,n);$disableButton.href=o,$disableIcon.innerHTML=i,e.disabled_for_catalogs_at?$("#modal_disable").modal("show"):$disableNotice.remove()}return $disableButton={},$disableIcon={},$disableNotice={},{init:e}}(),ql.labIndexView=function(){function e(){(n=[].concat(_toConsumableArray(document.querySelectorAll(".js-lab-row")))).length&&(n[i].focus(),window.addEventListener("keyup",t))}function t(e){"ArrowDown"===e.key?n[i+1]&&n[++i].focus():"ArrowUp"===e.key&&n[i-1]&&n[--i].focus()}var n=[],i=0;return{init:e}}(),ql.labInlineInstructionComponents=function(){var e=["ql-activity-tracking","ql-multiple-choice-probe","ql-multiple-select-probe","ql-true-false-probe"].join(", ");return{updateLabInstanceId:function t(){$(e).attr("labInstanceId",ql.labData.getLabInstanceId())}}}(),ql.labIntroduction=function(){function e(e){window.YT&&(r=document.querySelector(".js-lab-introduction"))&&(r.addEventListener("transitionend",s,!1),document.querySelectorAll(".js-skip-button").forEach(function(e){return e.addEventListener("click",i,!1)}),localStorage.getItem("labIntroViewed")||e||t(),YT.ready(function(){a=new YT.Player("lab-introduction",{events:{onReady:function e(){},onStateChange:n}})}))}function t(){r.classList.remove("is-hidden"),r.classList.remove("is-invisible")}function n(e){e.data===YT.PlayerState.ENDED&&o()}function i(){o(),a&&a.pauseVideo()}function o(){r.classList.add("is-invisible"),localStorage.setItem("labIntroViewed",!0)}function s(e){e.target==r&&"opacity"==e.propertyName&&e.target.classList.add("is-hidden")}var a=undefined,r=undefined;return{init:e}}(),ql.labOutline={links:function(){function e(){s=document.querySelector(".js-lab-content"),r=s.querySelectorAll("h2"),a=s.querySelector(".js-lab-content-outline"),(l=a.querySelectorAll("a")).forEach(function(e){return e.addEventListener("click",t)}),window.addEventListener("scroll",i)}function t(e){e.preventDefault(),ql.track("clicked_lab_outline",{label:e.target.innerText});var t=e.target.getAttribute("href"),n=s.querySelector(t);n&&$("html, body").animate({scrollTop:n.offsetTop+o()-c},500,function(){e.target.blur(),i()})}function i(){requestAnimationFrame(function(){var t=window.scrollY-o()+u,e=[].concat(_toConsumableArray(r)).filter(function(e){return e.offsetTop<=t});n(e.length?e.pop():null)})}function n(e){(l.forEach(function(e){return e.classList.remove("is-active")}),null!=e)&&a.querySelector("a[href='#"+e.id+"']").classList.add("is-active")}function o(){return document.querySelector(".lab-content__inner-wrapper").offsetTop}var s=undefined,a=undefined,r=undefined,l=undefined,c=80,u=300;return{init:e}}(),layout:function(){function e(){n=document.querySelector(".js-lab-content-outline"),i=document.querySelector(".lab-content__inner-wrapper").offsetTop,window.addEventListener("scroll",t,!1),t()}function t(){requestAnimationFrame(function(){window.scrollY>i-o?n.classList.add("is-stuck"):n.classList.remove("is-stuck")})}var n=undefined,i=undefined,o=200;return{init:e}}()};var initRateItListener=function initRateItListener(){$(".js-rateit").bind("rated",function(e,t){setRating(t),$("#submit").data("disabled")||$("#submit").prop("disabled",!1)})},initReviewSubmitListener=function initReviewSubmitListener(){$(".js-lab-review-form").on("ajax:success",function(e,t,n,i){alertLabReviewSuccess(i)}).on("ajax:error",function(e,t){alertLabReviewError(t.responseText)})},alertLabReviewSuccess=function alertLabReviewSuccess(){$("#lab-review-modal").modal("hide"),$(".js-alert-message").html(trans.thanks_review),$(".js-alert").removeClass("alert-error").addClass("alert-success").css("display","flex")},alertLabReviewError=function alertLabReviewError(e){message=JSON.parse(e).message,$("#lab-review-modal").modal("hide"),$(".js-alert-message").html(message),$(".js-alert").removeClass("alert-success").addClass("alert-error").css("display","flex")},setRating=function setRating(e){$(".js-rating-input").val(e-3)},initLabReviewModal=function initLabReviewModal(){initRateItListener(),initReviewSubmitListener()};ql.labRun=function(){function e(){i=new hallofmirrors.lab.LabInstancePoller({labRunnerId:ql.labData.getFocusId(),labContainerType:ql.labData.getParent(),successCallback:function t(e){e.isExpired?ql.labRun.stopLab():(ql.labData.setLabInstanceId(e.labInstanceId),ql.labAssessment.update(e.assessmentInfo),ql.game.updateLabLeaderboard(e.gameLeaderboard),ql.labInlineInstructionComponents.updateLabInstanceId(),ql.labControlPanel.update(e))},errorCallback:function n(e){console.error("Lab poll error: ",e)}})}var i=undefined;return{init:function t(){ql.labControlPanel.init(),e(),ql.labData.isRunning()&&i.start()},startLab:function n(e){var t=e.justPaid;t||ql.track("clicked_start_lab_button",ql.labData.getAnalyticsPayload()),!ql.labData.isPaymentRequired()||t?(ql.labControlPanel.setStarting(),ql.labXhr.startLab().then(function(e){e.message&&hallofmirrors.snackbarService.alert(e.message),ql.track("lab_started",ql.labData.getAnalyticsPayload()),i.start()})["catch"](function(e){ql.labControlPanel.reset(),ql.labAlert.alertHttpError(e)})):$("#lab-access-modal").modal("show")},stopLab:function o(){ql.labControlPanel.setStopping(),ql.track("clicked_end_lab_button",ql.labData.getAnalyticsPayload()),ql.labXhr.stopLab().then(function(e){var t=e.runtime_error;ql.labData.clearLabInstanceId(),i.stop(),ql.labControlPanel.reset(),ql.labAssessment.reset(),t?ql.labAlert.alertMessage(t):$("#lab-review-modal").modal("show")})["catch"](function(e){ql.labAlert.alertHttpError(e),ql.labControlPanel.setRunning()})}}}(),ql.labXhr={startLab:function Jk(){return hallofmirrors.lab.labHttpService.startLab({labRunnerId:ql.labData.getFocusId(),labContainerType:ql.labData.getParent(),qlcampaign:ql.labData.getQlcampaign()})},stopLab:function Kk(){return hallofmirrors.lab.labHttpService.endLab({labInstanceId:ql.labData.getLabInstanceId()})}},ql.list=function(){function e(){document.querySelectorAll(".js-list-item").forEach(function(e){$expandToggle=e.querySelector(".js-list-item-expand"),$expandToggle.addEventListener("click",t,!1)})}function t(){$listItem=this.closest(".js-list-item"),$listItemDetails=$listItem.querySelector(".js-list-item-details"),$listItem.classList.toggle("is-expanded");var e=this.offsetHeight+$listItemDetails.offsetHeight;$listItem.style.height=e+"px"}return{init:e}}(),ql.MaterialDialog=function(e,t){this.dialog=e,this.dismissers=$(this.dialog).find("[data-dismiss]"),this.isOpen=t||!1,this.listen(),this.upgrade(),this.render()},ql.MaterialDialog.prototype.upgrade=function(){$(this.dialog).addClass("is-upgraded")},ql.MaterialDialog.prototype.listen=function(){for(var e=0;e<this.dismissers.length;e++)this.dismissers[e].addEventListener("click",this.close.bind(this))},ql.MaterialDialog.prototype.close=function(){this.isOpen=!1,this.render()},ql.MaterialDialog.prototype.open=function(){this.isOpen=!0,this.render()},ql.MaterialDialog.prototype.render=function(){this.isOpen?$(this.dialog).addClass("is-open"):$(this.dialog).removeClass("is-open")},ql.MaterialInput=function(e){this.input=e,this.wrapper=this.input.parentElement.parentElement,this.isFilled=!!this.input.value,this.isValid=!0,this.listen(),this.upgrade()},ql.MaterialInput.prototype.listen=function(){this.input.addEventListener("input",this.setAndRender.bind(this)),this.input.addEventListener("blur",this.setAndRender.bind(this))},ql.MaterialInput.prototype.upgrade=function(){$(this.input).addClass("is-upgraded")},ql.MaterialInput.prototype.setAndRender=function(){this.setAttributes(),this.isFilled?$(this.input).addClass("is-filled"):$(this.input).removeClass("is-filled"),this.isValid?$(this.wrapper).removeClass("has-error"):$(this.wrapper).addClass("has-error")},ql.MaterialInput.prototype.setAttributes=function(){this.setIsFilled(),this.setIsValid()},ql.MaterialInput.prototype.setIsFilled=function(){this.isFilled=!!this.input.value},ql.MaterialInput.prototype.setIsValid=function(){this.isValid=this.input.validity.valid},ql.initMaterialInputs=function(e){if((e=e||[]).length)var t=e.find(".md-input__input");else t=document.getElementsByClassName("md-input__input");for(var n=0;n<t.length;n++)$(t[n]).hasClass("is-upgraded")||new ql.MaterialInput(t[n])},ql.modals=function(){function e(){$(".modal[data-show]").modal("show"),$(".modal[data-modal-shown-path]").on("show.bs.modal",function(){$.get(this.dataset.modalShownPath)}).modal("show")}return{init:e}}(),ql.navPanel=function(){function e(){n=document.querySelector(".js-nav-panel"),document.querySelectorAll(".js-nav-toggle").forEach(function(e){return e.addEventListener("click",t)})}function t(e){e.preventDefault(),n.classList.toggle("is-open"),ql.track("Side navigation toggled",{category:"Navigation"})}var n=undefined;return{init:e}}(),ql.navigation=function(){function e(){document.querySelectorAll(".js-navigation-button").forEach(function(e){e.addEventListener("click",t,!1)})}function t(){ql.track("Navigation link clicked",{category:"Navigation",label:this.title})}undefined;return{init:e}}(),ql.initNewLabWindowListener=function(){$(window).resize(function(){ql.setHorizontal()})},ql.setHorizontal=function(){$(window).width()<600?($(".md-input").removeClass("md-input--horizontal"),$(".js-permissions-select").removeClass("permissions-select__container--horizontal"),$(".js-labs-resources").removeClass("labs__resources--horizontal")):($(".md-input").addClass("md-input--horizontal"),$(".js-student-resources .md-input").removeClass("md-input--horizontal"),$(".js-permissions-select").addClass("permissions-select__container--horizontal"),$(".js-labs-resources").addClass("labs__resources--horizontal"))},ql.initNewStudentResourceListener=function(){$(document).on("nested:fieldAdded",function(e){for(var t=e.field.find(".md-input__input"),n=0;n<t.length;n++)new ql.MaterialInput(t[n])})},ql.initInstructionRemovedListener=function(){$(document).on("nested:fieldRemoved",function(e){e.field.next(".js-add-instruction").click()})};var initNewLab=function initNewLab(){ql.setHorizontal(),ql.initNewLabWindowListener(),ql.initNewStudentResourceListener(),ql.initInstructionRemovedListener()};ql.initNewLabLocale=function(){ql.initNewLabLocaleButtonListener(),ql.initNewLabLocaleSubmitListener()},ql.initNewLabLocaleButtonListener=function(){$(".js-new-lab-locale-button").on("ajax:success",function(e,t,n,i){$(".js-new-lab-locale").html(i.responseText),ql.initMaterialInputs($(".js-new-lab-locale")),ql.newLabLocaleDialog=new ql.MaterialDialog($(".js-dialog"),!0)})},ql.initNewLabLocaleSubmitListener=function(){$(document).on("ajax:success","form",function(e,t,n,i){ql.newLabLocaleDialog.close(),$(".js-lab-locales-table").find(".flex-table__row:nth-child(1)").after(i.responseText),$(".js-lab-locales-table").find(".flex-table__row:nth-child(2)").addClass("is-new")}).on("ajax:error","form",function(){console.log("aww")})},ql.pagination=function(){function e(){t(),n()}function t(){o=document.querySelectorAll(".js-pagination select")}function n(){o.forEach(function(e){e.addEventListener("change",i)})}function i(e){e.preventDefault(),this.closest("form")?this.closest("form").submit():window.location.search+="&per_page="+this.value}var o="";return{init:e}}();var initPaymentsPage=function initPaymentsPage(){$(".js-purchase-option").first().prop("checked",!0)},initRadioButtonListener=function initRadioButtonListener(){$(".js-purchase-option").change(function(){$(".js-purchase-option").siblings(".js-purchase-option-details").removeClass("is-selected"),$(this).siblings(".js-purchase-option-details").addClass("is-selected"),updateTotal(),$(this).hasClass("js-other-credit")||$(".js-other-credit").prop("disabled",!0)})},initOtherRadioButtonListener=function initOtherRadioButtonListener(){$(".js-other-option").change(function(){$(".js-other-credit").prop("disabled",!1).focus()})},initOtherInputListener=function initOtherInputListener(){$(".js-other-credit").on("keyup mouseup change",function(){$(".js-other-option").val($(this).val()),updateTotal()})},initAddPromoCodeButtonListener=function initAddPromoCodeButtonListener(){$(".js-add-promo-code-button").click(function(e){e.preventDefault();var t=$(".js-purchase-option:checked"),n=t.val().trim(),i=t.data("product-code"),o=$(".js-promo-code").val().trim(),s=$(".js-payments-paths").data("validate-promo-code-path");if(null==o||") && (quantity == null || quantity == "==o)return!1;$.get(s,{uuid:o,credits:n,product_code:i},null,"html").success(function(e){$(".js-payment-details").html(e),$("#payment_details_modal").modal("show"),initRedeemPromoCodeButtonListener(),updateTotal()})})},initRedeemPromoCodeButtonListener=function initRedeemPromoCodeButtonListener(){$("#redeem_now").click(function(){redeemNowUrl=$(".js-payments-paths").data("redeem-now-path"),promoCode=$(".js-promo-code").val().trim(),$.post(redeemNowUrl,{uuid:promoCode}).fail(function(e){alert("Redeem call failed: "+e.responseText)}).done(function(e){window.location.href=e})})},updateTotal=function updateTotal(){var e=$(".js-purchase-option:checked"),t=e.val().trim(),n=e.data("product-code"),i=$(".js-promo-code").val().trim(),o=e.data("course-id"),s=$(".js-payments-paths").data("calculate-total-path");$.get(s,{quantity:t,product_code:n,promo_code:i,course_id:o},null,"json").success(function(e){e.full_price.subtotal?($(".js-payment-sub-total").html(e.full_price.subtotal),$(".js-payment-tax").html(e.full_price.tax),$(".js-payment-total").html(e.full_price.total)):$(".js-payment-total").html(e.price),$(".js-payment-total").data("price_in_cents",e.price_in_cents)})},initStripeButton=function initStripeButton(){if($(".js-stripe-button").length){var r=$(".js-stripe-button").data("currency"),e="usd"===r||"cny"===r,l=StripeCheckout.configure({key:$(".js-stripe-button").data("key"),currency:$(".js-stripe-button").data("currency"),alipay:e,locale:"auto",token:function c(e){var t=$(".js-purchase-option:checked"),n=t.val().trim(),i=t.data("product-code"),o=$(".js-promo-code").val().trim(),s=$(".js-stripe-button").data("process-path"),a=t.data("courseId");$.post(s,{stripeEmail:e.email,stripeToken:e.id,quantity:n,promo_code:o,product_code:i,course_id:a,referrer:$(".js-stripe-button").data("referrer").trim()}).fail(function(e){console.log("Stripe call failed: "+e)}).done(function(e){window.location.href=e})}});$(".js-stripe-button").on("click",function(e){e.preventDefault();var t=$(".js-purchase-option:checked"),n=t.val().trim(),i=t.data("product-code"),o=$(".js-promo-code").val().trim(),s=t.data("course-id"),a=$(".js-payments-paths").data("validate-path");$.post(a,{quantity:n,promo_code:o,product_code:i,course_id:s}).fail(function(e){$(".js-payment-details").html(e.responseText),$("#payment_details_modal").modal("show"),initRedeemPromoCodeButtonListener()}).done(function(){var e=$(".js-payments-paths").data("calculate-total-path");$.get(e,{quantity:n,promo_code:o,product_code:i,course_id:s},null,"json").success(function(e){console.log(spluralize(n,i)),"undefined"!=typeof analytics&&(analytics.track("payment",{product_code:i,promo_code:o,currency:r,quantity:n,amount:e.price_in_cents}),console.log("payment event sent")),l.open({description:e.title,amount:e.price_in_cents})})})}),$(window).on("popstate",function(){l.close()})}var n=$(".js-change-credit-card");if(n.length){var t=StripeCheckout.configure({key:n.data("key"),locale:"auto",token:function c(e){var t=n.data("process-path");$.post(t,{stripeToken:e.id,referrer:n.data("referrer").trim()}).fail(function(e){console.log("Stripe call failed: "+e)}).done(function(e){window.location.href=e})}});n.on("click",function(e){e.preventDefault(),t.open({description:"Update Card Details",panelLabel:"Update Card Details"}),$(window).on("popstate",function(){t.close()})})}},spluralize=function spluralize(e,t){return 1==e?e+" "+t:e+" "+t+"s"},initPayments=function initPayments(){initPaymentsPage(),updateTotal(),initRadioButtonListener(),initOtherRadioButtonListener(),initOtherInputListener(),initAddPromoCodeButtonListener(),initStripeButton()};ql.Permissions=function(e){var t=this;this.button=e,this.menu=new ql.PermissionsMenu($('ul[for="'+this.button.attr("id")+'"]')),this.overlay=$('aside[for="'+this.button.attr("id")+'"]'),this.permissions=this.button.data("permissions"),this.menu.setPermissions=function(e){t.setPermissions(e)},this.button.click(function(){t.menu.isVisible=!0,t.render()}),this.overlay.click(function(){t.menu.isVisible=!1,t.render()}),this.render()},ql.Permissions.prototype.setPermissions=function(e){var t=this.permissions.indexOf(e);0<=t?this.permissions.splice(t,1):this.permissions.push(e),$(".js-permissions-input").val(this.permissions.join("\r\n")),this.render()},ql.Permissions.prototype.render=function(){for(var e=[],t=0;t<this.permissions.length;t++)e.push("<span>"+this.permissions[t]+"</span>");this.button.find("#permissions-display").html(e),this.menu.render()},ql.PermissionsMenu=function(e){var t=this;this.element=e,this.isVisible=!1,this.setPermissions="",this.categories=[];for(var n=this.element.children("li"),i=0;i<n.length;i++)this.categories.push(new ql.PermissionsMenuCategory($(n[i]))),this.categories[i].setPermissions=function(e){t.setPermissions(e)}},ql.PermissionsMenu.prototype.render=function(){this.isVisible?this.element.addClass("is-visible"):this.element.removeClass("is-visible");for(var e=0;e<this.categories.length;e++)this.categories[e].render()},ql.PermissionsMenuCategory=function(e){var t=this;this.element=e,this.isSelected=!1,this.setPermissions="",this.items=[];for(var n=this.element.find("[data-permission]"),i=0;i<n.length;i++)this.items.push(new ql.PermissionsMenuItem($(n[i]))),this.items[i].setPermissions=function(e){t.setPermissions(e)}},ql.PermissionsMenuCategory.prototype.setSelected=function(){this.isSelected=!1;for(var e=0;e<this.items.length;e++)this.items[e].isSelected&&(this.isSelected=!0)},ql.PermissionsMenuCategory.prototype.render=function(){this.setSelected(),this.isSelected?this.element.addClass("is-selected"):this.element.removeClass("is-selected");for(var e=0;e<this.items.length;e++)this.items[e].render()},ql.PermissionsMenuItem=function(e){var t=this;this.element=e,this.isSelected=this.element[0].hasAttribute("data-selected"),this.permission=e.data("permission"),this.setPermissions="",this.element.click(function(){t.isSelected=!t.isSelected,t.setPermissions(t.permission)})},ql.PermissionsMenuItem.prototype.render=function(){this.isSelected?this.element.addClass("is-selected"):this.element.removeClass("is-selected")};var initPermissionsSelect=function initPermissionsSelect(){ql.permissions=new ql.Permissions($(".js-permissions"))};ql.initPublishModal=function(){$("#publish_modal").on("show.bs.modal",function(){ql.updatePublishModal(),setInterval(ql.updatePublishModal,5e3)}).modal()},ql.updatePublishModal=function(){console.log("updating publish modal");var t=$(".js-status").data("lab-id"),e=$(".js-status").data("url");$.get(e).done(function(e){"done"==e.status?window.location.href="/labs/"+t+"/snapshots/new":($("#snapshotJobModal .status").html("["+e.id+"] "+e.status),null!=e.message&&$("#snapshotJobModal .message").html(e.message))})},ql.quest={layout:function(){function e(){i=document.querySelector(".js-quest-sidebar"),n=document.querySelector(".js-quest-wrapper"),o=n.offsetTop,(s=document.querySelector("main")).addEventListener("scroll",t,!1)}function t(){requestAnimationFrame(function(){s.scrollTop>o-a?i.classList.add("is-stuck"):i.classList.remove("is-stuck")})}var n=undefined,i=undefined,o=undefined,s=undefined,a=117;return{init:e}}(),analytics:function(){function e(){var e={questName:gon.learning_path_name,label:gon.learning_path_name,category:"Quest",deployment:gon.deployment},t=document.querySelector(".js-quest-enroll-button"),n=document.querySelector(".js-quest-unenroll-button");document.querySelectorAll(".js-catalog-item-title a").forEach(function(e){return e.addEventListener("click",function(e){ql.track("clicked_quest_activity_link",{label:e.target.innerText,type:e.target.dataset.type})},!1)}),t&&t.addEventListener("click",function(){ql.track("clicked_quest_enroll_button",e)}),n&&n.addEventListener("click",function(){ql.track("clicked_quest_unenroll_button",e)})}return{init:e}}()};var initSearchAutocomplete=function initSearchAutocomplete(){jQuery.ui.autocomplete.prototype._resizeMenu=function(){this.menu.element.outerWidth(this.element.outerWidth())},0<$(".js-autocomplete").length&&$.getJSON("/searches/autocomplete.json",function(e){window.SEARCH_AUTOCOMPLETE_DISABLED||(e=e.map($.trim).sort(function(e,t){return e.localeCompare(t)}),$(".js-autocomplete").autocomplete({source:e}))})},disableSearchAutocomplete=function disableSearchAutocomplete(){$(".js-autocomplete").autocomplete("instance")&&$(".js-autocomplete").autocomplete("disable")},initSearch=function initSearch(){initSearchAutocomplete(),$searchInput=document.getElementById("keywords"),$searchInput&&$searchInput.addEventListener("keydown",function(e){e.isComposing||13!=e.keyCode||ql.track("searched",{label:e.target.value})})};$(function(){function e(){var e=ql.experiments.getActiveExperiments().map(function(e){return e.optimize_id+"."+e.variant_index}).join("!");ga("set","exp",e)}if(gon.segment!=undefined){!function(){var n=window.analytics=window.analytics||[];if(!n.initialize)if(n.invoked)window.console&&console.error&&console.error("Segment snippet included twice.");else{n.invoked=!0,n.methods=["trackSubmit","trackClick","trackLink","trackForm","pageview","identify","reset","group","track","ready","alias","page","once","off","on"],n.factory=function(t){return function(){var e=Array.prototype.slice.call(arguments);return e.unshift(t),n.push(e),n}};for(var e=0;e<n.methods.length;e++){var t=n.methods[e];n[t]=n.factory(t)}n.load=function(e){var t=document.createElement("script");t.type="text/javascript",t.async=!0,t.src=("https:"===document.location.protocol?"https://":"http://")+"cdn.segment.com/analytics.js/v1/"+e+"/analytics.min.js";var n=document.getElementsByTagName("script")[0];n.parentNode.insertBefore(t,n)},n.SNIPPET_VERSION="3.1.0",n.load(gon.segment)}}();var t="none";if(gon.deployment!=undefined&&(t=gon.deployment),gon.hasOwnProperty("current_user")){var n=gon.current_user;analytics.identify(t+"-"+n.id,{email:n.email,first_name:n.firstname,last_name:n.lastname,company:n.company,origin:n.origin,name:n.fullname,subscriptions:n.subscriptions,qlCreatedAt:n.qlCreatedAt,optIn:n.optIn,deployment:t})}analytics.ready(function(){e(),analytics.page()})}}),initQuestCollapse=function(){$(".js-dashboard-quest").click(function(){$(this).find(".js-toggle-arrow").toggleClass("is-shown")})},initDismissAlert=function(){$(".js-dashboard-alert-close").click(function(){$.get($(this).data("dismissed-path"))})},initStudentDashboard=function(){initQuestCollapse(),initDismissAlert()},initFirstTabActive=function(){$(".js-tab").first().addClass("is-active"),$(".js-tab-content").first().addClass("is-active")},initTabListener=function(){$(".js-tab").click(function(){var e=$(this).data("tab");$(".js-tab").removeClass("is-active"),$(this).addClass("is-active"),$(".js-tab-content").removeClass("is-active"),$(".js-tab-content[data-tab='"+e+"']").addClass("is-active")})},initTabs=function(){initTabListener()},ql.toggleButtons=function(){function e(){document.querySelectorAll(".toggle-button").forEach(function(e){e.hasAttribute("for")?e.addEventListener("click",t,!1):e.disabled=!0})}function t(){this.classList.toggle("is-toggled"),document.getElementById(this.getAttribute("for")).classList.toggle("is-toggled")}return{init:e}}(),initTooltips=function(){$('[data-toggle="tooltip"]').tooltip()}
;var trans={},initLabTranslations=function initLabTranslations(e){trans=e},initPaymentTranslations=function initPaymentTranslations(e){trans=e};ql.affiliateAutocomplete=function(){function e(){$(".js-affiliate-user-autocomplete").userAutocomplete({source:function i(e,t){var n="?q["+this.element[0].dataset.query+"]="+e.term;ql.getJson(this.element[0].dataset.autocomplete+n).then(function(e){t(e.map(function(e){return{label:e,value:e.email}}))})},open:function e(){$(".js-add-new-user").click(t)}})}function t(){var e=$(".js-affiliate-user-autocomplete").val();$('.js-new-user input[type="email"]').val(e),$(".js-new-user").removeClass("is-hidden"),$(".js-existing-user").addClass("is-hidden")}return{init:e}}();